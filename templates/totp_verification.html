<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PicUI - ä¸¤æ­¥éªŒè¯</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ–¼ï¸</text></svg>">
    <!-- å¼•å…¥TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Nunito', system-ui, sans-serif;
            background-color: #f9fafb;
            background-image: 
                radial-gradient(circle at 25px 25px, #e5e7eb 2px, transparent 0),
                radial-gradient(circle at 75px 75px, #e5e7eb 2px, transparent 0);
            background-size: 100px 100px;
        }
        
        .totp-container {
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.95);
        }
        
        .btn {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .logo-text {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .error-message {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* è‡ªåŠ¨èšç„¦éªŒè¯ç è¾“å…¥å­—æ®µ */
        input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center py-10">
    <div class="totp-container mx-auto p-8 rounded-3xl">
        <div class="flex items-center justify-center mb-6">
            <div class="bg-blue-500 text-white p-3 rounded-xl mr-3 shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
            </div>
            <h1 class="text-3xl font-bold">
                <span class="logo-text">PicUI</span>
                <span class="text-gray-700">ä¸¤æ­¥éªŒè¯</span>
            </h1>
        </div>
        
        <!-- æç¤ºä¿¡æ¯ -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-blue-700">
                        æ¬¢è¿å›æ¥ï¼Œ<strong>{{ username }}</strong>ï¼<br>
                        è¯·è¾“å…¥æ‚¨çš„ä¸¤æ­¥éªŒè¯ç å®Œæˆç™»å½•ã€‚
                    </p>
                </div>
            </div>
        </div>
        
        <!-- é”™è¯¯æç¤º -->
        {% if error %}
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 error-message">
            <strong class="font-bold">éªŒè¯å¤±è´¥ï¼</strong>
            <span class="block sm:inline">{{ error }}</span>
        </div>
        {% endif %}
        
        <!-- éªŒè¯ç è¡¨å• -->
        <form method="post" action="/verify-totp" class="space-y-6">
            <div>
                <label for="totp_code" class="block text-sm font-medium text-gray-700 mb-2">éªŒè¯ç </label>
                <input type="text" id="totp_code" name="totp_code" required autofocus
                       class="w-full px-4 py-3 text-center text-2xl font-mono font-bold tracking-widest border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors"
                       placeholder="000000"
                       maxlength="6"
                       pattern="\d{6}"
                       autocomplete="off">
                <p class="mt-2 text-sm text-gray-500">è¯·è¾“å…¥æ‚¨çš„èº«ä»½éªŒè¯å™¨åº”ç”¨ä¸­æ˜¾ç¤ºçš„6ä½éªŒè¯ç </p>
            </div>
            
            <div class="pt-2">
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors btn">
                    éªŒè¯
                </button>
            </div>
        </form>
        
        <div class="mt-6 text-center">
            <a href="/logout" class="text-blue-500 hover:text-blue-700 text-sm">å–æ¶ˆå¹¶è¿”å›ç™»å½•é¡µ</a>
        </div>
    </div>
    
    <script>
        // è‡ªåŠ¨èšç„¦éªŒè¯ç è¾“å…¥æ¡†
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('totp_code').focus();
            
            // æ·»åŠ æ•°å­—è¾“å…¥é™åˆ¶
            document.getElementById('totp_code').addEventListener('input', function(e) {
                this.value = this.value.replace(/\D/g, '').substr(0, 6);
                if (this.value.length === 6) {
                    this.form.submit();
                }
            });
        });
    </script>
</body>
</html> 